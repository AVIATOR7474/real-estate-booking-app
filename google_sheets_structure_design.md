# تصميم هيكل جداول Google Sheets لتطبيق حجز مواعيد العروض التقديمية

## مقدمة
سيتم تصميم هيكل جداول Google Sheets ليكون المصدر الرئيسي للبيانات في تطبيق حجز مواعيد العروض التقديمية لشركات التطوير العقاري. سيتم إدخال البيانات في Google Sheets أولاً، ثم عرضها وإدارتها من خلال واجهة Streamlit.

## أوراق العمل (Sheets)

### 1. ورقة الحجوزات (Bookings)
هذه الورقة ستحتوي على جميع بيانات الحجوزات.

| العمود | نوع البيانات | الوصف |
|-------|-------------|-------|
| booking_id | نص | معرف فريد للحجز (سيتم إنشاؤه تلقائيًا) |
| company_name | نص | اسم شركة التطوير العقاري |
| area_name | نص | اسم المنطقة |
| project_name | نص | اسم المشروع الذي سيتم له العرض التقديمي |
| representative_name | نص | اسم ممثل الشركة الذي سيقوم بالعرض |
| contact_email | نص | البريد الإلكتروني للتواصل |
| contact_phone | نص | رقم الهاتف للتواصل |
| booking_date | تاريخ | تاريخ الحجز (يجب أن يكون يوم سبت أو ثلاثاء) |
| booking_time | نص | وقت الحجز (12:00 - 12:30 ظهراً) |
| status | نص | حالة الحجز (مؤكد، ملغي، مرحل) |
| notes | نص | ملاحظات إضافية |
| created_at | تاريخ/وقت | تاريخ ووقت إنشاء الحجز |
| updated_at | تاريخ/وقت | تاريخ ووقت آخر تحديث للحجز |

### 2. ورقة المواعيد المتاحة (Available_Slots)
هذه الورقة ستحتوي على المواعيد المتاحة للحجز.

| العمود | نوع البيانات | الوصف |
|-------|-------------|-------|
| slot_id | نص | معرف فريد للموعد |
| slot_date | تاريخ | تاريخ الموعد المتاح |
| slot_day | نص | اسم اليوم (السبت أو الثلاثاء) |
| slot_time | نص | وقت الموعد المتاح (12:00 - 12:30 ظهراً) |
| is_available | نص/منطقي | هل الموعد متاح أم محجوز (Yes/No) |
| booking_id | نص | معرف الحجز المرتبط بهذا الموعد (إذا كان محجوزًا) |

### 3. ورقة شركات التطوير العقاري (Companies)
هذه الورقة ستحتوي على بيانات شركات التطوير العقاري.

| العمود | نوع البيانات | الوصف |
|-------|-------------|-------|
| company_id | نص | معرف فريد للشركة |
| company_name | نص | اسم الشركة |
| contact_person | نص | اسم الشخص المسؤول |
| contact_email | نص | البريد الإلكتروني للتواصل |
| contact_phone | نص | رقم الهاتف للتواصل |
| address | نص | عنوان الشركة |
| notes | نص | ملاحظات إضافية |

### 4. ورقة المشاريع (Projects)
هذه الورقة ستحتوي على بيانات المشاريع العقارية.

| العمود | نوع البيانات | الوصف |
|-------|-------------|-------|
| project_id | نص | معرف فريد للمشروع |
| project_name | نص | اسم المشروع |
| company_id | نص | معرف الشركة المالكة للمشروع |
| area_name | نص | اسم المنطقة |
| project_type | نص | نوع المشروع (سكني، تجاري، إلخ) |
| description | نص | وصف المشروع |
| status | نص | حالة المشروع (قيد الإنشاء، مكتمل، إلخ) |

### 5. ورقة الإعدادات (Settings)
هذه الورقة ستحتوي على إعدادات التطبيق.

| العمود | نوع البيانات | الوصف |
|-------|-------------|-------|
| setting_name | نص | اسم الإعداد |
| setting_value | نص | قيمة الإعداد |
| description | نص | وصف الإعداد |

## العلاقات بين الجداول

1. **الحجوزات والمواعيد المتاحة**:
   - عندما يتم إنشاء حجز جديد، يتم تحديث حالة الموعد المقابل في جدول المواعيد المتاحة إلى "غير متاح" (No).
   - يتم ربط الحجز بالموعد من خلال حقل booking_id في جدول المواعيد المتاحة.

2. **الحجوزات والشركات**:
   - يتم ربط الحجز بالشركة من خلال اسم الشركة (company_name).
   - يمكن استخدام بيانات الشركة المخزنة في جدول الشركات لملء بيانات الحجز تلقائيًا.

3. **الحجوزات والمشاريع**:
   - يتم ربط الحجز بالمشروع من خلال اسم المشروع (project_name).
   - يمكن استخدام بيانات المشروع المخزنة في جدول المشاريع لملء بيانات الحجز تلقائيًا.

## آلية عمل النظام

1. **إنشاء المواعيد المتاحة**:
   - يتم إنشاء المواعيد المتاحة تلقائيًا لأيام السبت والثلاثاء للأسابيع القادمة.
   - يمكن للمسؤول إضافة أو إزالة مواعيد متاحة يدويًا من خلال جدول المواعيد المتاحة.

2. **إنشاء حجز جديد**:
   - يتم إدخال بيانات الحجز في جدول الحجوزات.
   - يتم تحديث حالة الموعد المقابل في جدول المواعيد المتاحة.

3. **ترحيل موعد**:
   - يتم تحديث بيانات الحجز في جدول الحجوزات.
   - يتم تحديث حالة الموعد القديم والجديد في جدول المواعيد المتاحة.

4. **إلغاء حجز**:
   - يتم تحديث حالة الحجز في جدول الحجوزات إلى "ملغي".
   - يتم تحديث حالة الموعد المقابل في جدول المواعيد المتاحة إلى "متاح" (Yes).

## الصيغ والقواعد

1. **التحقق من صحة التاريخ**:
   - يجب أن يكون تاريخ الحجز يوم سبت أو ثلاثاء فقط.
   - يمكن استخدام صيغة في Google Sheets للتحقق من ذلك:
     ```
     =OR(WEEKDAY(A2, 2)=6, WEEKDAY(A2, 2)=2)
     ```
     حيث A2 هو خلية تاريخ الحجز، و6 يمثل السبت، و2 يمثل الثلاثاء في نظام WEEKDAY حيث الاثنين=1.

2. **إنشاء معرف فريد**:
   - يمكن إنشاء معرف فريد للحجز باستخدام صيغة:
     ```
     ="BK" & TEXT(NOW(), "yyyymmddhhmmss")
     ```

3. **التحقق من توفر الموعد**:
   - قبل إنشاء حجز جديد، يجب التحقق من أن الموعد متاح في جدول المواعيد المتاحة.
   - يمكن استخدام صيغة VLOOKUP للتحقق من ذلك.

## الأتمتة والماكرو

يمكن استخدام Google Apps Script لأتمتة بعض العمليات:

1. **إنشاء المواعيد المتاحة تلقائيًا**:
   - إنشاء سكريبت يقوم بإنشاء المواعيد المتاحة لأيام السبت والثلاثاء للأسابيع القادمة.

2. **إرسال إشعارات البريد الإلكتروني**:
   - إرسال إشعار بالبريد الإلكتروني عند إنشاء حجز جديد أو ترحيل موعد أو إلغاء حجز.

3. **التحقق من صحة البيانات**:
   - التحقق من صحة البيانات المدخلة في جدول الحجوزات.

4. **تحديث حالة المواعيد تلقائيًا**:
   - تحديث حالة المواعيد في جدول المواعيد المتاحة تلقائيًا عند إنشاء أو ترحيل أو إلغاء حجز.

## الخلاصة

هذا التصميم يوفر هيكلًا شاملًا لجداول Google Sheets لتطبيق حجز مواعيد العروض التقديمية لشركات التطوير العقاري. يمكن استخدام هذا الهيكل كأساس لتطوير التطبيق، مع إمكانية تعديله حسب الاحتياجات المحددة.
